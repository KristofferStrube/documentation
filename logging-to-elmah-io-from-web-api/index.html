<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <meta name="author" content="Thomas Ardal">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@elmah_io">
    <meta name="twitter:creator" content="@elmah_io">
    <meta name="twitter:title" content="Logging from Web API | elmah.io">
    
    
    <meta property="og:title" content="Logging from Web API | elmah.io">
    
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://docs.elmah.io/logging-to-elmah-io-from-web-api/">
    
    <meta property="fb:app_id" content="218008838347208" />
    <title>Logging from Web API | elmah.io</title>
    <link rel="canonical" href="https://docs.elmah.io/logging-to-elmah-io-from-web-api/">
    <link rel="shortcut icon" href="../.././favicon.ico">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../.././assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="../.././assets/fonts/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="../.././assets/css/jquery.mCustomScrollbar.css">
    <link rel="stylesheet" href="../.././assets/css/highlight.css">
    <link rel="stylesheet" href="../.././assets/css/style.css">
  </head>
  <body>
    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-WKDV74"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-WKDV74');</script>
    <!-- End Google Tag Manager -->

    <!-- Navigation -->
    <nav class="navbar navbar-expand-md navbar-dark bg-dark">
  <div class="container">
    <a class="navbar-brand" href="https://elmah.io/">
      <img src="../.././assets/img/logo.png" alt="elmah.io">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarText">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item"><a class="nav-link" href="https://elmah.io/features/">Features</a></li>
        <li class="nav-item"><a class="nav-link" href="https://elmah.io/pricing/">Pricing</a></li>
        <li class="nav-item"><a class="nav-link" href="https://elmah.io/tour/">Tour</a></li>
        <li class="nav-item"><a class="nav-link" href="https://elmah.io/about/">About</a></li>
        <li class="nav-item"><a class="nav-link" href="https://docs.elmah.io/">Docs</a></li>
        <li class="nav-item"><a class="nav-link" href="https://blog.elmah.io/">Blog</a></li>
      </ul>
      <ul class="navbar-nav navbar-nav-btn">
    	<li class="nav-item mr-md-2 mb-2 mb-md-0"><a class="btn btn-outline-light" href="https://app.elmah.io/signup/">Sign Up</a></li>
        <li class="nav-item"><a class="btn btn-outline-light" href="https://app.elmah.io/login/">Login</a></li>
      </ul>
    </div>
  </div>
</nav>

    <div class="container mb-5">
      <div class="row">
        <aside class="sidebar">
          <div class="sidebar-body">
            <div class="input-group mb-3">
              <div class="input-group-prepend"><span class="input-group-text"><i class="fa fa-search"></i></span></div>
              <input type="text" id="search" class="form-control" placeholder="Search ..." />
            </div>
            <div id="searchList"></div>
            <hr>
            <a id="show-all-links" href="javascript:;" class="btn btn-light btn-block d-block d-md-none">Show documentation links</a>
            <ul class="main-nav d-none d-md-block">
              
              <li>
                <a href="javascript:;">Docs</a>
                <ul>
                  
                  <li ><a href="..">Home</a></li>
                  
                </ul>
              </li>
              
              <li>
                <a href="javascript:;">Installation</a>
                <ul>
                  
                  <li ><a href="../logging-to-elmah-io-from-elmah/">Logging from ELMAH</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-aspnet-mvc/">Logging from ASP.NET MVC</a></li>
                  
                  <li class="active"><a href="./">Logging from Web API</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-aspnet-core/">Logging from ASP.NET Core</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-serilog/">Logging from Serilog</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-log4net/">Logging from log4net</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-nlog/">Logging from NLog</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-microsoft-extensions-logging/">Logging from Microsoft.Extensions.Logging</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-javascript/">Logging from JavaScript</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-entity-framework-core/">Logging from Entity Framework Core</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-logary/">Logging from Logary</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-nancy/">Logging from Nancy</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-servicestack/">Logging from ServiceStack</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-blogengine-net/">Logging from BlogEngine.NET</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-umbraco/">Logging from Umbraco</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-jsnlog/">Logging from JSNLog</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-console-application/">Logging from Console</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-system-diagnostics/">Logging from System.Diagnostics</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-powershell/">Logging from PowerShell</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-sitefinity/">Logging from Sitefinity</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-express/">Logging from Express</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-wcf/">Logging from WCF</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-azure-webjobs/">Logging from Azure WebJobs</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-azure-functions/">Logging from Azure Functions</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-aws-lambdas/">Logging from AWS Lambdas</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-devexpress/">Logging from DevExpress (eXpressApp Framework)</a></li>
                  
                  <li ><a href="../logging-to-elmah-io-from-orchard/">Logging from Orchard</a></li>
                  
                  <li ><a href="../configure-elmah-io-manually/">Configure elmah.io manually</a></li>
                  
                  <li ><a href="../configure-elmah-io-from-code/">Configure elmah.io from code</a></li>
                  
                  <li ><a href="../logging-through-a-http-proxy/">Logging through a HTTP proxy</a></li>
                  
                </ul>
              </li>
              
              <li>
                <a href="javascript:;">Apps</a>
                <ul>
                  
                  <li ><a href="../elmah-io-apps-slack/">Slack</a></li>
                  
                  <li ><a href="../elmah-io-apps-hipchat/">HipChat</a></li>
                  
                  <li ><a href="../elmah-io-apps-github/">GitHub</a></li>
                  
                  <li ><a href="../elmah-io-apps-bitbucket/">Bitbucket</a></li>
                  
                  <li ><a href="../elmah-io-apps-jira/">Jira</a></li>
                  
                  <li ><a href="../elmah-io-apps-teams/">Microsoft Teams</a></li>
                  
                  <li ><a href="../elmah-io-apps-botbuster/">BotBuster</a></li>
                  
                  <li ><a href="../elmah-io-apps-ipfilter/">IP Filter</a></li>
                  
                  <li ><a href="../elmah-io-apps-mailman/">Mailman</a></li>
                  
                  <li ><a href="../elmah-io-apps-webclient/">WebClient</a></li>
                  
                  <li ><a href="../elmah-io-apps-youtrack/">YouTrack</a></li>
                  
                  <li ><a href="../elmah-io-apps-gitlab/">GitLab</a></li>
                  
                  <li ><a href="../elmah-io-apps-azure-boards/">Azure Boards</a></li>
                  
                  <li ><a href="../creating-apps-for-elmah-io/">Creating apps for elmah.io</a></li>
                  
                </ul>
              </li>
              
              <li>
                <a href="javascript:;">Help</a>
                <ul>
                  
                  <li ><a href="../tips-and-tricks-to-stay-below-your-message-limit/">Tips and tricks to stay below your message limit</a></li>
                  
                  <li ><a href="../logging-custom-data/">Logging custom data</a></li>
                  
                  <li ><a href="../logging-errors-programmatically/">Logging errors programmatically</a></li>
                  
                  <li ><a href="../logging-to-multiple-elmah-logs/">Logging to multiple logs</a></li>
                  
                  <li ><a href="../remove-sensitive-form-data/">Remove sensitive form data</a></li>
                  
                  <li ><a href="../setup-deployment-tracking/">Set Up Deployment Tracking</a></li>
                  
                  <li ><a href="../managing-organisations-and-users/">Managing Organisations and Users</a></li>
                  
                  <li ><a href="../handle-elmah-io-downtime/">Handle elmah.io downtime</a></li>
                  
                  <li ><a href="../use-extended-user-details-without-email-as-id/">Use Extended User Details without Email as Id</a></li>
                  
                  <li ><a href="../use-multiple-logs-for-different-environments/">Use multiple logs for different environments</a></li>
                  
                  <li ><a href="../specify-api-key-and-log-id-through-appsettings/">Specify API key and log ID through appSettings</a></li>
                  
                  <li ><a href="../adding-version-information/">Adding version information</a></li>
                  
                  <li ><a href="../include-filename-and-line-number-in-stacktraces/">Include filename and line number in stack traces</a></li>
                  
                  <li ><a href="../elmah-and-custom-errors/">ELMAH and custom errors</a></li>
                  
                  <li ><a href="../using-the-elmah-io-extension-for-visual-studio/">Using the elmah.io extension for Visual Studio</a></li>
                  
                  <li ><a href="../using-the-rest-api/">Using the REST API</a></li>
                  
                  <li ><a href="../creating-rules-to-perform-actions-on-messages/">Creating Rules to Perform Actions on Messages</a></li>
                  
                  <li ><a href="../query-messages-using-full-text-search/">Query messages using full-text search</a></li>
                  
                  <li ><a href="../where-is-my-log-id/">Where is my log ID</a></li>
                  
                  <li ><a href="../where-is-my-api-key/">Where is my API key</a></li>
                  
                  <li ><a href="../missing-server-side-information-on-uptime-errors/">Missing server side information on uptime errors</a></li>
                  
                  <li ><a href="../export-data-from-elmah-io-to-json/">Export data from elmah.io to JSON</a></li>
                  
                  <li ><a href="../upgrade-elmah-io-from-v2-to-v3/">Upgrade elmah.io from v2 to v3</a></li>
                  
                  <li ><a href="../how-prices-are-calculated/">How prices are calculated</a></li>
                  
                  <li ><a href="../how-to-configure-api-key-permissions/">How to configure API key permissions</a></li>
                  
                  <li ><a href="../elmah-and-elmah-io-differences/">ELMAH and elmah.io differences</a></li>
                  
                  <li ><a href="../integrate-elmah-io-with-slack/">Integrating with Slack manually</a></li>
                  
                  <li ><a href="../integrate-elmah-io-with-hipchat/">Integrating with HipChat manually</a></li>
                  
                  <li ><a href="../integrate-elmah-io-with-zapier/">Integrating with Zapier</a></li>
                  
                </ul>
              </li>
              
            </ul>
          </div>
        </aside>
        <article class="col main-content">
          <div class="main-content-body">

            <p><a href="https://ci.appveyor.com/project/ThomasArdal/elmah-io"><img alt="Build status" src="https://ci.appveyor.com/api/projects/status/j82k842uc26w2drg?svg=true" /></a>
<a href="https://www.nuget.org/packages/Elmah.Io.WebApi"><img alt="NuGet" src="https://img.shields.io/nuget/v/Elmah.Io.WebApi.svg" /></a>
<a href="https://github.com/elmahio/elmah.io/tree/master/samples/Elmah.Io.WebApi"><img alt="Samples" src="https://img.shields.io/badge/samples-1-brightgreen.svg" /></a></p>
<h1 id="logging-to-elmahio-from-web-api">Logging to elmah.io from Web API</h1>
<p>Web API provides its own mechanism for handling errors, why ELMAH’s modules and handlers doesn’t work there. Luckily, Richard Dingwall created the <a href="https://www.nuget.org/packages/Elmah.Contrib.WebApi/">Elmah.Contrib.WebApi</a> NuGet package to fix this. We've built a package for ASP.NET Web API exclusively, which installs all the necessary packages.</p>
<p>To start logging exceptions from Web API, install the NuGet package:</p>
<pre><code class="powershell">Install-Package Elmah.Io.WebApi
</code></pre>

<p>During the installation, you will be asked for your API key (<a href="https://docs.elmah.io/where-is-my-api-key/">Where is my API key?</a>) and log ID (<a href="https://docs.elmah.io/where-is-my-log-id/">Where is my log ID?</a>).</p>
<ul class="nav nav-tabs" role="tablist">
    <li role="presentation" class="nav-item"><a class="nav-link active" href="#setup2" aria-controls="home" role="tab" data-toggle="tab">Web API 2.x</a></li>
    <li role="presentation" class="nav-item"><a class="nav-link" href="#setup1" aria-controls="profile" role="tab" data-toggle="tab">Web API 1.x</a></li>
</ul>

<p><div class="tab-content">
    <div role="tabpanel" class="tab-pane active" id="setup2"></p>
<p>Add the following code to your <code>WebApiConfig.cs</code> file:</p>
<pre><code class="csharp">public static class WebApiConfig
{
    public static void Register(HttpConfiguration config)
    {
        ...
        config.Services.Add(typeof(IExceptionLogger), new ElmahExceptionLogger());
        ...
    }
}
</code></pre>

<p>The registered <code>IExceptionLogger</code> intercepts all thrown exceptions, even errors in controller contructors and routing errors.</p>
<p></div>
  <div role="tabpanel" class="tab-pane" id="setup1">
Add the following code to your <code>Global.asax.cs</code> file:</p>
<pre><code class="csharp">protected void Application_Start()
{
    ...
    GlobalConfiguration.Configuration.Filters.Add(new ElmahHandleErrorApiAttribute());
    ...
}
</code></pre>

<p>In this case you register a new global filter with Web API. The downside of this approach is, that only errors thrown in controller actions are logged.
  </div>
</div></p>
<p>All uncaught exceptions in ASP.NET Web API are now logged to elmah.io</p>
<h2 id="logging-from-exceptionaction-filters">Logging from exception/action filters</h2>
<p>It's a widely used Web API approach, to handle all exceptions in a global exception/action filter and return a nicely formatted JSON/XML error response to the client. This is a nice approach to avoid throwing internal server errors, but it also puts ELMAH out of the game. When catching any exception manually and converting it to a response message, errors won't be logged in elmah.io.</p>
<p>To overcome this, errors should be logged manually from your global exception/action filter:</p>
<pre><code class="csharp">public class NotImplExceptionFilterAttribute : ExceptionFilterAttribute 
{
    public override void OnException(HttpActionExecutedContext context)
    {
        ErrorSignal.FromCurrentContext().Raise(context.Exception);

        // Now generate the result to the client
    }
}
</code></pre>

            <br/>
            <p><small><em>This article was brought to you by the elmah.io team. elmah.io is the best error management system for .NET web applications. We monitor your website, alert you when errors start happening and help you fix errors fast.</em></small></p>
            <p class="text-center">
                <a href="https://app.elmah.io/signup/" class="btn btn-lg btn-primary d-none d-sm-block" style="white-space: normal;">See how we can help you monitor your website for crashes</a>
                <a href="https://app.elmah.io/signup/" class="btn btn-lg btn-primary d-block d-sm-none">Monitor your website</a>
            </p>
          </div>
        </article>
      </div>
    </div>

    <footer>
    	<div class="pre-footer">
	    	<div class="container">
	    		<div class="company-logo">
					<img class="img-fluid" src="../.././assets/img/elmahio.png" alt="elmah.io">
				</div>
				<a href="https://app.elmah.io/signup/" class="btn btn-primary float-right"><span>Sign Up Now</span><span class="info">no credit card required - free 21-day trial</span></a>
			</div>
	    </div>
    	<div class="links">
    		<div class="container">
    			<div class="row">
    				<div class="col">
    					<h5>Product</h5>
    					<ul class="list-unstyled">
							<li><a href="https://elmah.io/features/">Features</a></li>
							<li><a href="https://elmah.io/pricing/">Pricing</a></li>
							<li><a href="https://elmah.io/api">API</a></li>
							<li><a href="https://headwayapp.co/elmah-io-changelog" rel="noopener noreferrer" target="_blank">Changelog</a></li>
						</ul>
    				</div>
    				<div class="col">
    					<h5>Company</h5>
						<ul class="list-unstyled">
							<li><a href="https://elmah.io/about/">About</a></li>
							<li><a href="https://elmah.io/contact/">Contact</a></li>
							<li><a href="https://blog.elmah.io/">Blog</a></li>
							<li><a href="https://docs.elmah.io/">Docs</a></li>
						</ul>
    				</div>
    				<div class="col">
    					<h5>Learn</h5>
						<ul class="list-unstyled">
							<li><a href="https://elmah.io/customer-stories/">Customer Stories</a></li>
							<li><a href="https://elmah.io/for-ctos/">For CEOs and CTOs</a></li>
							<li><a href="https://elmah.io/goodiebag/">Goodie Bag</a></li>
							<li><a href="https://elmah.io/tools/configvalidator/">Web.config Validator</a></li>
						</ul>
    				</div>
    				<div class="col">
    					<h5>Guides</h5>
						<ul class="list-unstyled">
							<li><a href="https://elmah.io/devops/">.NET DevOps</a></li>
							<li><a href="https://elmah.io/microservices/">.NET Microservices</a></li>
							<li><a href="https://elmah.io/cloud-logging/">.NET Cloud Logging</a></li>
						</ul>
    				</div>
                    <div class="col">
                        <h5>Social</h5>
                        <ul class="list-unstyled social">
                            <li class="list-inline-item"><a href="https://twitter.com/elmah_io"><i class="fa fa-twitter"></i></a></li>
                            <li class="list-inline-item"><a href="https://facebook.com/elmahdotio"><i class="fa fa-facebook"></i></a></li>
                            <li class="list-inline-item"><a href="https://plus.google.com/+ElmahIoPlus"><i class="fa fa-google-plus"></i></a></li>
                            <li class="list-inline-item"><a href="https://www.linkedin.com/company/5354798"><i class="fa fa-linkedin"></i></a></li>
                        </ul>
                    </div>
    			</div>
    		</div>
    	</div>
    	<div class="copyright">
    		<div class="container">
    			<div class="text-center">
					<p>2013 - 2018 @ elmah.io. All Rights Reserved.</p>
					<p><a href="https://elmah.io/legal/terms-of-use/">Terms of Use</a> | <a href="https://elmah.io/legal/privacy-policy/">Privacy Policy</a> | <a href="https://elmah.io/legal/refund-policy/">Refund Policy</a></p>
				</div>
    		</div>
    	</div>
    </footer>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://cdn.rawgit.com/elmahio/elmah.io.js/3.0.0-beta2/dist/elmahio.min.js?apiKey=a789ddece0bd47fe83390b702f5713a9&logId=24c89075-e32a-4a79-9f7e-e78381e0d761" type="text/javascript"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>
    <script src="../.././assets/js/bootstrap.min.js"></script>
    <script src="../.././assets/js/highlight.pack.js"></script>
    <script src="../.././assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
    <script src="../.././assets/js/fuse.min.js"></script>
    <script src="../.././assets/js/main.js"></script>
  </body>
</html>